<style>

	button.btn, input {
		font-family: 'Lato', sans-serif !important;
	}

	.wrapper {
		width:500px;
		padding-top: 85px;
		margin: 0 auto;
	}

	h3 {
		padding-top: 25px;
		font-weight:300;
	}

	a:hover {
		text-decoration:none !important;
		color:black;
		opacity:1;
	}

	.disco_content {
		text-align: center;
	}

	.btn_login {
		margin-top: 22px;
		margin-bottom: 10px;
		width: 110px;
	}

	a {
		color: black;
		opacity: 0.6;
	}

	.btn_back {
		margin-top: -4px;
	}

	.txt_email, .txt_password {
		
	}

	.btn_help {
		color: black;
		opacity: 0.6;
		margin-top:-8px;
		font-size: 0.8em;
		text-align:center;
	}

	.btn_help:hover {
		opacity: 0.9;
		cursor: pointer;
	}

	.btn-custom {
		background-color: hsl(0, 0%, 23%) !important;
		background-repeat: repeat-x;
		filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#494949", endColorstr="#3a3a3a");
		background-image: -khtml-gradient(linear, left top, left bottom, from(#494949), to(#3a3a3a));
		background-image: -moz-linear-gradient(top, #494949, #3a3a3a);
		background-image: -ms-linear-gradient(top, #494949, #3a3a3a);
		background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #494949), color-stop(100%, #3a3a3a));
		background-image: -webkit-linear-gradient(top, #494949, #3a3a3a);
		background-image: -o-linear-gradient(top, #494949, #3a3a3a);
		background-image: linear-gradient(#494949, #3a3a3a);
		border-color: #3a3a3a #3a3a3a hsl(0, 0%, 21.5%);
		color: #fff !important;
		text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.09);
		-webkit-font-smoothing: antialiased;
	}

	.btn-custom-2 {
		background-color: hsl(29, 100%, 46%) !important;
		background-repeat: repeat-x;
		filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#ff7b00", endColorstr="#ea7100");
		background-image: -khtml-gradient(linear, left top, left bottom, from(#ff7b00), to(#ea7100));
		background-image: -moz-linear-gradient(top, #ff7b00, #ea7100);
		background-image: -ms-linear-gradient(top, #ff7b00, #ea7100);
		background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #ff7b00), color-stop(100%, #ea7100));
		background-image: -webkit-linear-gradient(top, #ff7b00, #ea7100);
		background-image: -o-linear-gradient(top, #ff7b00, #ea7100);
		background-image: linear-gradient(#ff7b00, #ea7100);
		border-color: #ea7100 #ea7100 hsl(29, 100%, 45%);
		color: #fff !important;
		text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.06);
		-webkit-font-smoothing: antialiased;
	}

</style>

<div class="wrapper">
	<div class="disco_logo"><img src="/img/DiscoLogoBeta.png"></div>
	<div class="disco_content">
		<h3> Log in with your account email: </h3>
		<input class="txt_email" type="email" placeholder="Email" name="email"><br/>
		<input class="txt_password" type="password" placeholder="Password" name="password" style="display:none">
		<div class="btn_help" onclick="window.alert('Enter the email you first used to sign up with. \nIf you can\'t remember your email or password, contact us at team@groupnotes.ca')"> Forgot your email or password?</div>
		<div><button class="btn btn-inverse btn-custom btn_login">Login</button><div>
		<div class="btn_back"> <a href="/welcome"> Back </a> </div>
	</div>
</div>

<script>
	discoDetect(null, '/extension-get', '/no-chrome');
</script>

<script>
	$(".txt_email").focus();
	

	$("input").on("keypress", function(e) {
		if (e.keyCode == 13){
			$('.btn_login').click();
		}
	}); 

	var checkPassword = function() {
		var email = $('.txt_email').val();
		if (email && email.indexOf('@') > -1 && email.indexOf('.') > -1) {
			$.post('/has-password', { email: email }, function(data) {
				if (data.hasPassword) {
					yesPassword();
				} else {
					noPassword();
				}
			})
		} else {
			noPassword();
		}
	};

	$('.txt_email').keyup(checkPassword).blur(checkPassword).change(checkPassword);

	var noPassword = function() {
		$('.txt_password').hide();
	};

	var yesPassword = function() {
		$('.txt_password').show();
	}


	$('.btn_login').on('click', function(e) {
		e.preventDefault();
		var email = $('.txt_email').val();
		var password = $('.txt_password').val();

		if (!email || !email.length) {
			alert('Please enter an email');
		} else {
			$.post('/login', {
				email:email,
				password: password
			}, function(data) {
				if (data && data.success) {
					window.location = '/logged-in';
				} else if (data.message) {
					alert(data.message);
				} else {
					alert('Data did not return from server in an expected manner, please email jason@groupnotes.ca to alert us of the error. We\'ll love you forever');
				}
			});
		}
	});
</script>