
<style>
	.wrapper {
		width:500px;
		padding-top: 85px;
		margin: 0 auto;
		text-align: center;
	}

	h4 {
		padding-top:25px;
		font-weight: 300;
		padding-bottom: 8px;
	}

	button.btn, input {
		font-family: 'Lato', sans-serif !important;
	}


	.btn-custom {
		background-color: hsl(0, 0%, 23%) !important;
		background-repeat: repeat-x;
		filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#494949", endColorstr="#3a3a3a");
		background-image: -khtml-gradient(linear, left top, left bottom, from(#494949), to(#3a3a3a));
		background-image: -moz-linear-gradient(top, #494949, #3a3a3a);
		background-image: -ms-linear-gradient(top, #494949, #3a3a3a);
		background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #494949), color-stop(100%, #3a3a3a));
		background-image: -webkit-linear-gradient(top, #494949, #3a3a3a);
		background-image: -o-linear-gradient(top, #494949, #3a3a3a);
		background-image: linear-gradient(#494949, #3a3a3a);
		border-color: #3a3a3a #3a3a3a hsl(0, 0%, 21.5%);
		color: #fff !important;
		text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.09);
		-webkit-font-smoothing: antialiased;
	}

	.btn-custom-2 {
		background-color: hsl(29, 100%, 46%) !important;
		background-repeat: repeat-x;
		filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#ff7b00", endColorstr="#ea7100");
		background-image: -khtml-gradient(linear, left top, left bottom, from(#ff7b00), to(#ea7100));
		background-image: -moz-linear-gradient(top, #ff7b00, #ea7100);
		background-image: -ms-linear-gradient(top, #ff7b00, #ea7100);
		background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #ff7b00), color-stop(100%, #ea7100));
		background-image: -webkit-linear-gradient(top, #ff7b00, #ea7100);
		background-image: -o-linear-gradient(top, #ff7b00, #ea7100);
		background-image: linear-gradient(#ff7b00, #ea7100);
		border-color: #ea7100 #ea7100 hsl(29, 100%, 45%);
		color: #fff !important;
		text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.06);
		-webkit-font-smoothing: antialiased;
	}

	.new-password {
	}

	.old-password {
	}

	.submit-btn {
		margin-bottom:10px;
	}

	.hasPasswordHeader {
	}

	.first-name{
		width: 100px;
		margin-right: 3px;
	}

	.last-name{
		width: 100px;
	}

	.new-password{
		width: 220px;
	}

	.btn_back {
		margin-top: -6px;
		font-size: .8em;
	}
	
	a {
		color: black;
		opacity: 0.6;
	}

	a:hover {
		text-decoration:none !important;
		color:black;
		opacity:1;
	}

</style>

<form>
	<div class="wrapper">
		<div class="disco_logo"><img src="/img/DiscoLogoBeta.png"></div>
		<div class="disco_content">






		<% if (hasPassword) { %>
			<!-- Change your password page -->

			<h4 class = "hasPasswordHeader"> Set a new password for your account below: </h4>
			<input class="old-password" type="password" name="oldPassword" placeholder="Old Password"><br/>


		<% } else { %>
			<!-- Old users who need to upgrade their account to include a password -->

			<h4>We've added names and passwords to Disco! <br/></h4>
			<h5 style="text-decoration: none;">Set your name and new password here:<br/></h5>

		<% } %>

		<input class="first-name" type="text" name="firstName" placeholder="First Name">
		<input class="last-name" type="text" name="lastName" placeholder="Last Name"><br />
		<input class="new-password" type="password" name="newPassword" placeholder="New Password"><br/><br/>


		<input class="btn btn-custom submit-btn" type="submit"><br/>

		</div>
	</div>
</form>

<script>

	$('form').submit(function(e) {
		e.stopPropagation();
		e.preventDefault();

		var oldPassword = $('.old-password').val();
		var newPassword = $('.new-password').val();
		var firstName = $('.first-name').val();
		var lastName = $('.last-name').val();

		$.post('/change-password', {
			oldPassword: oldPassword,
			newPassword: newPassword,
			firstName: firstName,
			lastName: lastName
		}, function(data) {
			if (data.success) {
				alert('Success! Your password has been changed');
				window.location = '/logged-in';
			} <% if (!hasPassword) { %>
			else if (data.reason == 'Invalid old password! Did you forget it?!') {
				alert(data.reason);
				window.location = '/logged-in';
			} <% } %>
			else {
				alert(data.reason);
			}
		});

		return false;
	});

</script>